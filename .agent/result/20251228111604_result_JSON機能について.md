# 結果報告書: JSON機能について

## 1. JSONダウンロード機能の使用方法
本ゲームの「LLMベンチマークモード」で実行された対戦結果は、以下の手順でJSON形式としてダウンロードできます。

1.  UI右側の「LLM ベンチマークモード」パネルを開きます。
2.  「試合数」を設定し、「開始」ボタンを押してベンチマークを実行します。
    *   **注意**: 両方のプレイヤーが「AI」に設定されている必要があります。
3.  ベンチマークが進行し、少なくとも1試合が完了すると、パネル内に「**結果保存**」ボタンが表示されます。
4.  このボタンをクリックすると、現在までの対戦結果が含まれたJSONファイルが生成され、ダウンロードが開始されます。

## 2. ダウンロード先
ダウンロードされたファイルは、**お使いのブラウザで設定されているデフォルトのダウンロードフォルダ**（通常は `Downloads` または `ダウンロード` フォルダ）に保存されます。
ファイル名は `gemini_chess_benchmark_YYYY-MM-DDTHH:mm:ss.sssZ.json` のような形式（ISO 8601形式の日時を含む）になります。

## 3. 自動生成について
現在の仕様では、結果のJSONファイルは**自動では生成されません**。
ユーザーが明示的に「結果保存」ボタンをクリックしたタイミングでのみ、ファイルが生成・ダウンロードされます。全試合終了後でも、手動でボタンを押す必要があります。

## 4. 結果のJSONデータの具体例
生成されるJSONデータの形式（スキーマ）と具体例は以下の通りです。

### データ構造 (TypeScript型定義)
```typescript
interface BenchmarkResult {
  gameId: number;              // 何試合目か
  winner: 'w' | 'b' | 'draw';  // 勝者 ('w':白, 'b':黒, 'draw':引き分け)
  reason: string;              // 決着理由 (checkmate, stalemate, repetition 等)
  whiteProvider: string;       // 白側のAIモデル (例: gemini-3-flash-preview)
  blackProvider: string;       // 黒側のAIモデル
  moves: number;               // 総手数
  timestamp: string;           // 試合終了日時
  pgn: string;                 // PGN形式の棋譜データ
}
```

### JSONデータ例
```json
[
  {
    "gameId": 1,
    "winner": "w",
    "reason": "checkmate",
    "whiteProvider": "gemini-3-flash-preview",
    "blackProvider": "gemini-2.5-flash",
    "moves": 45,
    "timestamp": "2025-12-28T02:15:30.123Z",
    "pgn": "[Event \"LLM Benchmark\"]\n[Site \"Gemini Chess\"]\n[Date \"2025.12.28\"]\n[Round \"1\"]\n[White \"gemini-3-flash-preview\"]\n[Black \"gemini-2.5-flash\"]\n[Result \"1-0\"]\n\n1. e4 e5 2. Nf3 Nc6 3. Bb5 a6 4. Ba4 Nf6 5. O-O Be7 6. Re1 b5 7. Bb3 d6 8. c3 O-O 9. h3 Nb8 10. d4 Nbd7 11. c4 c6 12. cxb5 axb5 13. Nc3 Bb7 14. Bg5 h6 15. Bh4 Re8 16. Bg3 Bf8 17. Rc1 exd4 18. Nxd4 Nc5 19. Bc2 b4 20. Na4 Ncxe4 21. Bh4 c5 22. Nf5 g5 23. Bg3 Nxg3 24. Nxg3 Rxe1+ 25. Qxe1 Bc6 26. b3 Bxa4 27. bxa4 Qe8 28. Qd2 Qe5 29. Re1 Qb2 30. Bh7+ Kxh7 31. Qxb2 Bg7 32. Nf5 Bh8 33. Qc2 Kg8 34. Nxd6 Rd8 35. Qxc5 Bg7 36. Qc7 Rf8 37. Re7 Nd5 38. Qd7 Nxe7 39. Qxe7 Bc3 40. a5 Kg7 41. a6 Bf6 42. Qxf8+ Kxf8 43. a7 Be5 44. a8=Q+ Ke7 45. Nf5+ Kf6 46. Qe4 1-0"
  },
  {
    "gameId": 2,
    "winner": "draw",
    "reason": "repetition",
    "whiteProvider": "gemini-3-flash-preview",
    "blackProvider": "gemini-2.5-flash",
    "moves": 60,
    "timestamp": "2025-12-28T02:18:45.456Z",
    "pgn": "[Event \"LLM Benchmark\"]\n[Site \"Gemini Chess\"]\n[Date \"2025.12.28\"]\n[Round \"2\"]\n[White \"gemini-3-flash-preview\"]\n[Black \"gemini-2.5-flash\"]\n[Result \"1/2-1/2\"]\n\n1. d4 d5 2. c4 c6 3. Nf3 Nf6 4. Nc3 e6 5. Bg5 h6 6. Bh4 dxc4 7. e4 g5 8. Bg3 b5 9. Be2 Bb7 10. O-O Nbd7 11. Ne5 h5 12. Nxd7 Qxd7 13. Be5 Rh6 14. Qc1 Rg6 15. Rd1 g4 16. a4 Bh6 17. Bf4 Bxf4 18. Qxf4 a6 19. e5 Nd5 20. Nxd5 cxd5 21. axb5 axb5 22. Rxa8+ Bxa8 23. Ra1 Bc6 24. Qd2 Qe7 25. Ra6 Qb7 26. Qa5 Kf8 27. Rb6 Qd7 28. Qa6 Kg7 29. Rxc6 Qe7 30. Qxb5 Qg5 31. Rc7 Qc1+ 32. Bf1 Qf4 33. Qc5 h4 34. Rc8 Kh7 35. Qf8 Rg7 36. Qh8+ Kg6 37. Qxh4 Rh7 38. Rg8+ Rg7 39. Rh8 Qg5 40. Qxg5+ Kxg5 41. Be2 Kf4 42. Rh4 Ke4 43. Rxg4+ Rxg4 44. Bxg4 Kxd4 45. h4 Kxe5 46. h5 Kf6 47. f4 Kg7 48. Kf2 Kh6 49. Ke3 f5 50. Bf3 Kg7 51. Kd4 Kh6 52. Ke5Kg7 53. Kxe6 d4 54. Kxf5 c3 55. bxc3 dxc3 56. Be4 Kh6 57. g4 Kg7 58. g5 Kh7 59. Kf6+ Kg8 60. g6 Kh8 61. h6 Kg8 62. Bd5+ Kh8 63. g7+ Kh7 64. g8=Q+ Kxh6 65. Qg6# 1/2-1/2"
  }
]
```
